# B-05 状态管理（联邦项目）

联邦项目下**各应用独立**使用 Pinia，状态**不跨 app 共享**；共享的是组件、工具、类型，不是运行时状态。

- **库**：Pinia，每个 app 在自身包内安装并使用。
- **位置**：各 app 的 `src/stores/`，按业务域建文件（如 `user.ts`、`app.ts`），避免单文件过大。
- **与请求配合**：接口数据如需在**本 app 内**跨页面共享再放入 store；仅单页使用的放在页面或 composable 中。
- **命名**：store id 与文件名一致，清晰表达用途。
- **共享**：不在 shared-* 中放 Pinia store；若需跨 app 的配置，可放在 shared-utils 中的只读配置，由各 app 读取。

### 示例（各 app 内 Pinia store）

```ts
// packages/app-admin/src/stores/user.ts（仅本 app 使用）
import { defineStore } from 'pinia'

export const useUserStore = defineStore('user', {
  state: () => ({ name: '', rid: 0 }),
  actions: {
    setUser(payload: { name: string; rid: number }) {
      this.name = payload.name
      this.rid = payload.rid
    },
  },
})
```

```vue
<!-- 本 app 页面中使用 -->
<script setup lang="ts">
import { useUserStore } from '@/stores/user'
const userStore = useUserStore()
</script>
```

共用规则见 [shared/05-状态管理.md](../shared/05-状态管理.md)。
